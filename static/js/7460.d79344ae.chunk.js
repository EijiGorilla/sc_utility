"use strict";(self.webpackChunksc_utility=self.webpackChunksc_utility||[]).push([[7460,1340],{91340:(e,t,n)=>{n.d(t,{it:()=>Z,aX:()=>R,hR:()=>S});var r=n(42265),i=n(10064),s=n(32718),o=n(80885),l=n(29909),a=n(76335),c=n(92975),u=n(81753),p=(n(59486),n(76200)),f=n(77981),h=n(23084);var d=n(35995),g=n(35594);const y=()=>s.Z.getLogger("esri.geometry.support.normalizeUtils");function v(e){return"polygon"===e[0].type}function w(e){return"polyline"===e[0].type}function S(e,t){if(!(e instanceof l.Z||e instanceof o.Z)){const e="straightLineDensify: the input geometry is neither polyline nor polygon";throw y().error(e),new i.Z(e)}const n=(0,a.x3)(e),r=[];for(const i of n){const e=[];r.push(e),e.push([i[0][0],i[0][1]]);for(let n=0;n<i.length-1;n++){const r=i[n][0],s=i[n][1],o=i[n+1][0],l=i[n+1][1],a=Math.sqrt((o-r)*(o-r)+(l-s)*(l-s)),c=(l-s)/a,u=(o-r)/a,p=a/t;if(p>1){for(let l=1;l<=p-1;l++){const n=l*t,i=u*n+r,o=c*n+s;e.push([i,o])}const n=(a+Math.floor(p-1)*t)/2,i=u*n+r,o=c*n+s;e.push([i,o])}e.push([o,l])}}return function(e){return"polygon"===e.type}(e)?new o.Z({rings:r,spatialReference:e.spatialReference}):new l.Z({paths:r,spatialReference:e.spatialReference})}function m(e,t,n){if(t){const t=S(e,1e6);e=(0,u.Sx)(t,!0)}return n&&(e=(0,a.Sy)(e,n)),e}function x(e,t,n){if(Array.isArray(e)){const r=e[0];if(r>t){const n=(0,a.XZ)(r,t);e[0]=r+n*(-2*t)}else if(r<n){const t=(0,a.XZ)(r,n);e[0]=r+t*(-2*n)}}else{const r=e.x;if(r>t){const n=(0,a.XZ)(r,t);e=e.clone().offset(n*(-2*t),0)}else if(r<n){const t=(0,a.XZ)(r,n);e=e.clone().offset(t*(-2*n),0)}}return e}function M(e,t){let n=-1;for(let r=0;r<t.cutIndexes.length;r++){const i=t.cutIndexes[r],s=t.geometries[r],o=(0,a.x3)(s);for(let e=0;e<o.length;e++){const t=o[e];t.some((n=>{if(n[0]<180)return!0;{let n=0;for(let e=0;e<t.length;e++){const r=t[e][0];n=r>n?r:n}n=Number(n.toFixed(9));const r=-360*(0,a.XZ)(n,180);for(let i=0;i<t.length;i++){const t=s.getPoint(e,i);s.setPoint(e,i,t.clone().offset(r,0))}return!0}}))}if(i===n){if(v(e))for(const t of(0,a.x3)(s))e[i]=e[i].addRing(t);else if(w(e))for(const t of(0,a.x3)(s))e[i]=e[i].addPath(t)}else n=i,e[i]=s}return e}async function R(e,t,n){var i;if(!Array.isArray(e))return R([e],t);t&&"string"!=typeof t&&y().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const s="string"==typeof t?t:null!==(i=null===t||void 0===t?void 0:t.url)&&void 0!==i?i:r.default.geometryServiceUrl;let v,w,S,Z,b,P,C,U,X=0;const _=[],L=[];for(const r of e)if(null!=r)if(v||(v=r.spatialReference,w=(0,c.C5)(v),S=v.isWebMercator,P=S?102100:4326,Z=a.UZ[P].maxX,b=a.UZ[P].minX,C=a.UZ[P].plus180Line,U=a.UZ[P].minus180Line),w)if("mesh"===r.type)L.push(r);else if("point"===r.type)L.push(x(r.clone(),Z,b));else if("multipoint"===r.type){const e=r.clone();e.points=e.points.map((e=>x(e,Z,b))),L.push(e)}else if("extent"===r.type){const e=r.clone()._normalize(!1,!1,w);L.push(e.rings?new o.Z(e):e)}else if(r.extent){const e=r.extent,t=(0,a.XZ)(e.xmin,b)*(2*Z);let n=0===t?r.clone():(0,a.Sy)(r.clone(),t);e.offset(t,0);let{xmin:i,xmax:s}=e;i=Number(i.toFixed(9)),s=Number(s.toFixed(9)),e.intersects(C)&&s!==Z?(X=s>X?s:X,n=m(n,S),_.push(n),L.push("cut")):e.intersects(U)&&i!==b?(X=s*(2*Z)>X?s*(2*Z):X,n=m(n,S,360),_.push(n),L.push("cut")):L.push(n)}else L.push(r.clone());else L.push(r);else L.push(r);let G=(0,a.XZ)(X,Z),W=-90;const F=G,j=new l.Z;for(;G>0;){const e=360*G-180;j.addPath([[e,W],[e,-1*W]]),W*=-1,G--}if(_.length>0&&F>0){const t=M(_,await async function(e,t,n,r){const i=(0,h.en)(e),s=t[0].spatialReference,o={...r,responseType:"json",query:{...i.query,f:"json",sr:(0,c.B9)(s),target:JSON.stringify({geometryType:(0,f.Ji)(t[0]),geometries:t}),cutter:JSON.stringify(n)}},l=await(0,p.Z)(i.path+"/cut",o),{cutIndexes:a,geometries:u=[]}=l.data;return{cutIndexes:a,geometries:u.map((e=>{const t=(0,f.im)(e);return t.spatialReference=s,t}))}}(s,_,j,n)),r=[],i=[];for(let n=0;n<L.length;n++){const s=L[n];if("cut"!==s)i.push(s);else{const s=t.shift(),o=e[n];null!=o&&"polygon"===o.type&&o.rings&&o.rings.length>1&&s.rings.length>=o.rings.length?(r.push(s),i.push("simplify")):i.push(S?(0,u.$)(s):s)}}if(!r.length)return i;const o=await async function(e,t,n){const r="string"==typeof e?(0,d.mN)(e):e,i=t[0].spatialReference,s=(0,f.Ji)(t[0]),o={...n,query:{...r.query,f:"json",sr:(0,c.B9)(i),geometries:JSON.stringify((0,g.F)(t))}},{data:l}=await(0,p.Z)(r.path+"/simplify",o);return(0,g.o)(l.geometries,s,i)}(s,r,n),l=[];for(let e=0;e<i.length;e++){const t=i[e];"simplify"!==t?l.push(t):l.push(S?(0,u.$)(o.shift()):o.shift())}return l}const J=[];for(let r=0;r<L.length;r++){const e=L[r];if("cut"!==e)J.push(e);else{const e=_.shift();J.push(!0===S?(0,u.$)(e):e)}}return J}function Z(e,t,n){const r=(0,c.C5)(n);if(null==r)return e;const[i,s]=r.valid,o=2*s;let l=0,a=0;t>s?l=Math.ceil(Math.abs(t-s)/o):t<i&&(l=-Math.ceil(Math.abs(t-i)/o)),e>s?a=Math.ceil(Math.abs(e-s)/o):e<i&&(a=-Math.ceil(Math.abs(e-i)/o));let u=e+(l-a)*o;const p=u-t;return p>s?u-=o:p<i&&(u+=o),u}},76335:(e,t,n)=>{n.d(t,{Sy:()=>a,UZ:()=>o,XZ:()=>l,x3:()=>c});var r=n(29909),i=n(78952),s=n(77981);const o={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new r.Z({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:i.Z.WebMercator}),minus180Line:new r.Z({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:i.Z.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new r.Z({paths:[[[180,-180],[180,180]]],spatialReference:i.Z.WGS84}),minus180Line:new r.Z({paths:[[[-180,-180],[-180,180]]],spatialReference:i.Z.WGS84})}};function l(e,t){return Math.ceil((e-t)/(2*t))}function a(e,t){const n=c(e);for(const r of n)for(const e of r)e[0]+=t;return e}function c(e){return(0,s.oU)(e)?e.rings:e.paths}},47460:(e,t,n)=>{n.d(t,{GridSnappingEngine:()=>b});var r=n(27366),i=n(7138),s=n(32718),o=n(16889),l=n(68860),a=n(49861),c=(n(93169),n(84936),n(69912)),u=n(32035),p=n(79803),f=n(91340),h=n(82582);n(59486);var d=n(15559),g=n(92975),y=n(81753),v=n(78952),w=n(848),S=n(29909);function m(e,t,n){const r=1===e?10:e;return r**(n?Math.round(function(e,t){return Math.log(e)/Math.log(t)}(50/t,r)):0)}var x=n(38054),M=n(64674),R=n(65713),Z=n(53101);let b=class extends i.Z{constructor(e){super(e),this.options=null}destroy(){this._set("options",null)}get grid(){return this.view.grid}get effectiveViewRotation(){var e,t;return null!==(e=this.grid)&&void 0!==e&&e.rotateWithMap?0:(0,o.Vl)(null!==(t=this.view.rotation)&&void 0!==t?t:0)}get gridRotation(){var e,t;return(0,o.Vl)(null!==(e=null===(t=this.grid)||void 0===t?void 0:t.rotation)&&void 0!==e?e:0)}get gridCenter(){const{spatialReference:e,grid:t}=this;if(!t||!e||!(0,p.isLoadedOrLoadFor)(t.center.spatialReference,e))return null;try{var n;const r=(0,p.project)(t.center,e),i=e.isWrappable&&null!=(null===(n=this.view)||void 0===n?void 0:n.center)?(0,f.it)(r.x,this.view.center.x,e):r.x;return(0,x.Ue)(i,r.y,r.z)}catch(r){return s.Z.getLogger(this).errorOnce("Grid Snapping - Failed to project grid center.",r),null}}get offsetScaleFactor(){const{pixelsPerStride:e,grid:t}=this;if(!t||!e)return 1;const{majorLineInterval:n,dynamicScaling:r}=t;return n<1?null:m(n,e,r)}get spatialReference(){return this.view.spatialReference}get gridMetersPerStride(){const{grid:e}=this;return e?(0,l.En)(e.spacing,e.units,"meters"):null}get viewMetersPerPixel(){const{viewMetersPerSRUnit:e}=this;return null==e?null:e*(0,h.dp)(this.view.scale,this.view.spatialReference)}get viewMetersPerSRUnit(){const{spatialReference:e}=this.view;return this.gridCenter?function(e,t,n){var r,i;const s="number"==typeof e?null:e,o=null!==n&&void 0!==n?n:null===s||void 0===s?void 0:s.spatialReference;if(null==o||!(0,g.JY)(o)||function(e){const{isGeographic:t,isWebMercator:n}=e;return!t&&!n}(o))return(0,l.c9)(o);let a=null!==(r=null===s||void 0===s?void 0:s.x)&&void 0!==r?r:e,c=null!==(i=null===s||void 0===s?void 0:s.y)&&void 0!==i?i:t;const u=1/Math.sqrt(2);let p=a+u,h=c+u;const{isWebMercator:m,isGeographic:x}=o;let M=x&&!(0,d.Gb)(o)?v.Z.WGS84:o;if(m){let e=new w.Z({x:a,y:c,spatialReference:o});(0,y.Sx)(e,!0,e),a=e.x,c=e.y,e=new w.Z({x:p,y:h,spatialReference:o}),(0,y.Sx)(e,!0,e),p=e.x,h=e.y,M=v.Z.WGS84}const R=new S.Z({paths:[[[a,c],[p,h]]],spatialReference:M}),Z=(0,f.hR)(R,10);let b;try{[b]=(0,d.Jf)([Z],"meters")}catch{return(0,l.c9)(o)}return b}(this.gridCenter[0],this.gridCenter[1],e):null}get pixelsPerStride(){const{gridMetersPerStride:e,viewMetersPerPixel:t}=this;return t&&e?e/t:null}get updating(){return null!=this.grid&&null!=this.spatialReference&&null==this.viewMetersPerSRUnit}async fetchCandidates(e,t,n){var r;const{options:i,view:s}=this;if(null===i||void 0===i||!i.effectiveGridEnabled||!s.grid||null!==(r=n.feature)&&void 0!==r&&r.attributes&&M.Ry in n.feature.attributes)return[];const o=n.coordinateHelper.arrayToPoint(e),l=i.distance*("touch"===n.pointer?i.touchSensitivityMultiplier:1);return this.fetchCandidatesSync(o,l)}fetchCandidatesSync(e,t){const n=[],{grid:r,effectiveViewRotation:i,gridRotation:s,gridCenter:o,viewMetersPerPixel:l,viewMetersPerSRUnit:a,offsetScaleFactor:c,spatialReference:u,gridMetersPerStride:f,pixelsPerStride:h}=this;if(!(r&&l&&a&&o&&u&&c&&f&&h))return n;if(!r.dynamicScaling&&h<5)return n;if(!(0,p.isLoadedOrLoadFor)(e.spatialReference,u))return n;const d=(0,p.project)(e,u),g=(0,x.Ue)(d.x,d.y,d.z),y=P(g,-s,o,-i),v=f/a*c,w=C(y,v,o),{shouldSnapX:S,shouldSnapY:m}=U(w,y,t,l,a);if(!S&&!m)return[];const M=(0,x.Ue)((S?w:y)[0],(m?w:y)[1]),b=P(M,s,o,i),_=P(w,s,o,i);if(m){const e=X(w,y,v,"y"),t=P(e,s,o,i);n.push(new Z.u({lineStart:_,lineEnd:t,targetPoint:b,isDraped:!1}))}if(S){const e=X(w,y,v,"x"),t=P(e,s,o,i);n.push(new Z.u({lineStart:_,lineEnd:t,targetPoint:b,isDraped:!1}))}return S&&m&&n.push(new R.m(b,n[0],n[1],!1)),n}};(0,r._)([(0,a.Cb)({constructOnly:!0})],b.prototype,"view",void 0),(0,r._)([(0,a.Cb)()],b.prototype,"options",void 0),(0,r._)([(0,a.Cb)()],b.prototype,"grid",null),(0,r._)([(0,a.Cb)()],b.prototype,"effectiveViewRotation",null),(0,r._)([(0,a.Cb)()],b.prototype,"gridRotation",null),(0,r._)([(0,a.Cb)()],b.prototype,"gridCenter",null),(0,r._)([(0,a.Cb)()],b.prototype,"offsetScaleFactor",null),(0,r._)([(0,a.Cb)()],b.prototype,"spatialReference",null),(0,r._)([(0,a.Cb)()],b.prototype,"gridMetersPerStride",null),(0,r._)([(0,a.Cb)()],b.prototype,"viewMetersPerPixel",null),(0,r._)([(0,a.Cb)()],b.prototype,"viewMetersPerSRUnit",null),(0,r._)([(0,a.Cb)()],b.prototype,"pixelsPerStride",null),(0,r._)([(0,a.Cb)()],b.prototype,"updating",null),b=(0,r._)([(0,c.j)("esri.views.interactive.snapping.GridSnappingEngine")],b);const P=(e,t,n,r)=>{const i=(0,x.by)(e[0],e[1],e[2]);return(0,u.K)(i,(0,u.K)(i,i,n,t),n,r)},C=(e,t,n)=>{const r=(e[0]-n[0])/t,i=(e[1]-n[1])/t,s=Math.trunc(r),o=Math.trunc(i),l=Math.round(r%1),a=Math.round(i%1),c=n[0]+(s+l)*t,u=n[1]+(o+a)*t;return(0,x.Ue)(c,u)},U=(e,t,n,r,i)=>{if(r<=0)return{shouldSnapX:!1,shouldSnapY:!1};const s=(e[0]-t[0])/r,o=(e[1]-t[1])/r;return{shouldSnapX:Math.abs(s*i)<n,shouldSnapY:Math.abs(o*i)<n}},X=(e,t,n,r)=>{if("y"===r){const r=t[0]>e[0]?1:-1;return(0,x.Ue)(e[0]+n*r,e[1])}const i=t[1]>e[1]?1:-1;return(0,x.Ue)(e[0],e[1]+n*i)}}}]);
//# sourceMappingURL=7460.d79344ae.chunk.js.map