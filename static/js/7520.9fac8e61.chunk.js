"use strict";(self.webpackChunksc_utility=self.webpackChunksc_utility||[]).push([[7520],{67520:(e,t,r)=>{r.d(t,{Feature3DPipeline:()=>k});var n=r(27366),i=r(10064),a=r(42537),o=r(67426),s=r(94172),u=r(49861),d=(r(93169),r(32718),r(84936),r(69912)),l=r(3722),c=r(46798),y=r(53866),p=r(49818);let h=class extends o.D{constructor(e){super(e),this.schedule=null,this._workerUpdating=!0}get updating(){return this._workerUpdating}initialize(){this._workerHandle=new w(this.schedule,this);const{layer:e,viewSpatialReference:t,renderSpatialReference:r}=this;this.addResolvingPromise((async()=>await this._workerHandle.invokeMethod("setup",{url:e.parsedUrl?.path??"",baseQuery:e.createQuery().toJSON(),viewSpatialReference:t.toJSON(),renderSpatialReference:r.toJSON(),viewingMode:this.viewingMode,objectIdField:e.objectIdField,capabilities:e.capabilities,timeInfo:e.timeInfo?.toJSON(),fieldsIndex:e.fieldsIndex.toJSON()}))()),this.addHandles(this._workerHandle.on("notify-updating",(e=>{let{updating:t}=e;this._workerUpdating=t})))}async onTileTreeChange(e){let{added:t,removed:r}=e;if(0===t.length&&0===r.length)return;const n=t.map(g),i=r.map(m);await this._workerHandle.invokeMethod("onTileTreeChange",{added:n,removed:i})}async executeQuery(e,t){const r=await this._workerHandle.invokeMethod("executeQuery",e?.toJSON(),t),n=p.Z.fromJSON(r);return this._ensureLayerOnFeatures(n),n}async executeQueryForIds(e,t){return await this._workerHandle.invokeMethod("executeQueryForIds",e?.toJSON(),t)}async executeQueryForCount(e,t){return await this._workerHandle.invokeMethod("executeQueryForCount",e?.toJSON(),t)}async executeQueryForExtent(e,t){const{count:r,extent:n}=await this._workerHandle.invokeMethod("executeQueryForExtent",e?.toJSON(),t);return{count:r,extent:y.Z.fromJSON(n)}}async executeQueryForLatestObservations(e,t){const r=await this._workerHandle.invokeMethod("executeQueryForLatestObservations",e?.toJSON(),t),n=p.Z.fromJSON(r);return this._ensureLayerOnFeatures(n),n}_ensureLayerOnFeatures(e){const{layer:t}=this;for(const r of e.features)r.layer=t,r.sourceLayer=t}};(0,n._)([(0,u.Cb)()],h.prototype,"updating",null),(0,n._)([(0,u.Cb)({constructOnly:!0})],h.prototype,"schedule",void 0),(0,n._)([(0,u.Cb)({constructOnly:!0})],h.prototype,"layer",void 0),(0,n._)([(0,u.Cb)({constructOnly:!0})],h.prototype,"viewSpatialReference",void 0),(0,n._)([(0,u.Cb)({constructOnly:!0})],h.prototype,"renderSpatialReference",void 0),(0,n._)([(0,u.Cb)({constructOnly:!0})],h.prototype,"viewingMode",void 0),(0,n._)([(0,u.Cb)({constructOnly:!0})],h.prototype,"dispatchRenderCommands",void 0),(0,n._)([(0,u.Cb)()],h.prototype,"_workerUpdating",void 0),h=(0,n._)([(0,d.j)("esri.views.3d.layers.graphics.pipeline.Feature3DPipelineWorkerHandle")],h);class w extends c.q{constructor(e,t){super("Feature3DPipelineWorker","setup",{},e,{strategy:"dedicated",client:t})}}function g(e){let{id:t,lij:r,extent:n}=e;return{id:t,lij:r,extent:n}}function m(e){let{id:t}=e;return t}var v=r(75476),_=r(27732),f=r(20488),x=r(78485);let k=class extends o.D{constructor(e){super(e),this._renderer=null,this.graphicsQuery={queryForSymbologySnapping:(e,t)=>{throw new i.Z("unsupported-symbology-snapping")},executeQuery:async(e,t)=>await this._workerHandle.executeQuery(e,t),executeQueryForIds:async(e,t)=>await this._workerHandle.executeQueryForIds(e,t),executeQueryForCount:async(e,t)=>await this._workerHandle.executeQueryForCount(e,t),executeQueryForExtent:async(e,t)=>await this._workerHandle.executeQueryForExtent(e,t),executeQueryForLatestObservations:async(e,t)=>await this._workerHandle.executeQueryForLatestObservations(e,t)},this.maximumNumberOfFeatures=1e3}initialize(){if("point"!==this.layerView.layer.geometryType)throw new i.Z("unsupported-geometry-type",`${this.layerView.layer.geometryType} is not supported`);this.addResolvingPromise(this.setup())}async setup(){const{layer:e,view:t}=this.layerView,{spatialReference:r,renderSpatialReference:n,resourceController:i}=t,a=t.state.viewingMode;if(this._renderer=new v.mv({view:t,layerUid:e.uid}),"feature"!==e.type)throw new Error("Only FeatureLayer is supported");const o=new h({schedule:e=>i.immediate.schedule(e),layer:e,viewSpatialReference:r,renderSpatialReference:n,viewingMode:a,dispatchRenderCommands:e=>this._renderer.executeRenderCommands(e)});this._workerHandle=await o.when(),this.addHandles([this.layerView.view.featureTiles.addClient(),(0,s.on)((()=>this.layerView.view.featureTiles.tiles),"change",(e=>{this._workerHandle.onTileTreeChange(e)}),{onListenerAdd:e=>this._workerHandle.onTileTreeChange({added:e.toArray(),removed:[]}),onListenerRemove:e=>this._workerHandle.onTileTreeChange({added:[],removed:e.toArray()})})])}get legendEnabled(){return!1}get hasAllFeatures(){return!1}get hasAllFeaturesInView(){return!1}get hasFullGeometries(){return!1}get symbologySnappingSupported(){return!1}get scaleVisibilitySuspended(){return!1}get suspendInfo(){return{}}get updating(){return this._workerHandle.updating}get dataUpdating(){return!1}get updatePolicy(){return x.j.ASYNC}get maximumNumberOfFeaturesExceeded(){return!1}get updatingProgressValue(){return 1}get usedMemory(){return 100}get unloadedMemory(){return 0}get ignoresMemoryFactor(){return!0}get performanceInfo(){return new l.u(new f.W(this.usedMemory,0,0,this.maximumNumberOfFeatures,0,null),0,0,!0,"tiles","n/a")}get suspendResumeExtentMode(){return"computed"}forEachGraphic(e){}findGraphic(e){return null}highlight(e){return _.qK}maskOccludee(e){return(0,a.kB)()}async whenGraphicBounds(e,t){return null}computeAttachmentOrigin(e,t){return null}elevationAlignPointsInFeatures(e,t){throw new i.Z("unsupported-elevation-alignment")}async doRefresh(e){}setVisibility(e,t){}getMissingAttributesForFeature(e){return null}getHydratedGeometry(e){return null}};(0,n._)([(0,u.Cb)()],k.prototype,"layerView",void 0),(0,n._)([(0,u.Cb)()],k.prototype,"updating",null),k=(0,n._)([(0,d.j)("esri.views.3d.layers.graphics.pipeline.Feature3DPipeline")],k)}}]);
//# sourceMappingURL=7520.9fac8e61.chunk.js.map