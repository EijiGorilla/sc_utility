"use strict";(self.webpackChunksc_utility=self.webpackChunksc_utility||[]).push([[4714],{34311:(t,e,n)=>{function i(t,e,n){return{objectId:t,target:e,distance:n,type:"vertex"}}function s(t,e,n,i,s){return{objectId:t,target:e,distance:n,type:"edge",start:i,end:s,draped:arguments.length>5&&void 0!==arguments[5]&&arguments[5]}}n.d(e,{p:()=>s,u:()=>i})},34610:(t,e,n)=>{n.d(e,{Kb:()=>r,o2:()=>c,sV:()=>l,xn:()=>a});var i=n(51995),s=n(56011);function o(t,e){if(!t||t.symbol)return null;const n=e?.renderer;return t&&null!=n&&n.getObservationRenderer?n.getObservationRenderer(t):n}function r(t,e){const n=o(t,e),i=function(t,e){if(null!=t.symbol)return t.symbol;const n=o(t,e);return null!=n&&"dot-density"!==n.type?n.getSymbol(t,e):null}(t,e);if(null==i)return null;const r={renderer:n,symbol:i};if(null==n||!("visualVariables"in n)||!n.visualVariables)return r;const a=(0,s.getVisualVariableValues)(n,t,e)??[],l=["proportional","proportional","proportional"];for(const{variable:s,value:o}of a)switch(s.type){case"color":r.color=o.toRgba();break;case"size":if("outline"===s.target)r.outlineSize=o;else{const t=s.axis,e=s.useSymbolValue?"symbol-value":o;switch(t){case"width":l[0]=e;break;case"depth":l[1]=e;break;case"height":l[2]=e;break;case"width-and-depth":l[0]=l[1]=e;break;default:l[0]=l[1]=l[2]=e}}break;case"opacity":r.opacity=o;break;case"rotation":switch(s.axis){case"tilt":r.tilt=o;break;case"roll":r.roll=o;break;default:r.heading=o}}return"proportional"===l[0]&&"proportional"===l[1]&&"proportional"===l[2]||(r.size=l),r}async function a(t,e){const n=o(t,e),r=await async function(t,e){if(null!=t.symbol)return t.symbol;const n=o(t,e);return null!=n?n.getSymbolAsync(t,e):null}(t,e);if(!r)return null;const a={renderer:n,symbol:r};if(!n||!("visualVariables"in n)||!n.visualVariables)return a;const l=(0,s.getVisualVariableValues)(n,t,e)??[],c=["proportional","proportional","proportional"];for(const{variable:s,value:o}of l)if("color"===s.type)a.color=i.Z.toUnitRGBA(o);else if("size"===s.type)if("outline"===s.target)a.outlineSize=o;else{const t=s.axis,e=s.useSymbolValue?"symbol-value":o;"width"===t?c[0]=e:"depth"===t?c[1]=e:"height"===t?c[2]=e:c[0]=c[1]="width-and-depth"===t?e:c[2]=e}else"opacity"===s.type?a.opacity=o:"rotation"===s.type&&"tilt"===s.axis?a.tilt=o:"rotation"===s.type&&"roll"===s.axis?a.roll=o:"rotation"===s.type&&(a.heading=o);return(isFinite(c[0])||isFinite(c[1])||isFinite(c[2]))&&(a.size=c),a}function l(t){const e=t[arguments.length>1&&void 0!==arguments[1]?arguments[1]:0];return"number"==typeof e&&isFinite(e)?e:null}function c(t){for(let e=0;e<3;e++){const n=t[e];if("number"==typeof n)return isFinite(n)?n:0}return 0}},4714:(t,e,n)=>{n.d(e,{A:()=>j,m:()=>G});n(93169);var i=n(10064),s=n(84652),o=n(68860),r=n(79347),a=n(29303),l=n(21389),c=n(29134),u=n(7025),h=n(32035),p=n(12400),d=n(37998),g=n(41414),y=n(86372),f=n(39406),b=n(11186),m=n(34311),_=n(34610),x=n(50951),S=n(69691),v=n(58063),w=n(73614),P=n(96387),E=n(41325),I=n(64098),O=n(97689),C=n(94463),R=n(77648),U=n(27689),T=n(16010),M=n(91526),L=n(68401),A=n(79100),V=n(2952),z=n(17579),D=n(52920),B=n(66327),N=n(4760),k=n(72969);const F=["polygon","extent"];class G extends w.k{constructor(t,e,n,i){super(t,e,n,i),this.ensureDrapedStatus(!1)}async doLoad(){if(!this._drivenProperties.size){const t=(0,P.bh)(this._getSymbolSize());if(t)throw new i.Z("graphics3dextrudesymbollayer:invalid-size",t)}const t=this.symbolLayer?.material?.color,e=this._getCombinedOpacityAndColor(t),n=(0,p.nI)(e),s=e[3],o=s<1||this.needsDrivenTransparentPass,r=this.symbolLayer?.material?.emissiveFactor,a=r?(0,h.L)((0,p.d9)(r)):p.AG,l={usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0,diffuse:n,ambient:n,opacity:s,transparent:o,cullFace:o?L.Vr.None:L.Vr.Back,hasVertexColors:!0,hasSlicePlane:this._context.slicePlaneEnabled,castShadows:this.symbolLayer.castShadows,emissiveFactor:a,offsetTransparentBackfaces:!0,normalType:T.r.Compressed};this._materials[pt.Main]=new k.Gp(l,this._context),this._materials[pt.Bottom]=new k.Gp({...l,cullFace:L.Vr.Back},this._context),this._context.stage.addMany(this._materials)}destroy(){super.destroy(),this._context.stage.removeMany(this._materials),this._materials.length=0}createGraphics3DGraphic(t){const e=t.graphic;if(!this._validateGeometry(e.geometry,F,this.symbolLayer.type))return null;const n=this._getVertexOpacityAndColor(t.renderingInfo,255),i=this.setGraphicElevationContext(e);return this._createAs3DShape(e,t.renderingInfo,n,i,e.uid)}layerOpacityChanged(t,e){const n=this.symbolLayer?.material?.color,i=this._getCombinedOpacity(n),s=i<1||this.needsDrivenTransparentPass;this._materials[pt.Main]?.setParameters({opacity:i,transparent:s}),this._materials[pt.Bottom]?.setParameters({opacity:i,transparent:s});const o=this._getLayerOpacity();t.forEach((t=>e(t)?.layerOpacityChanged(o,this._context.isAsync)))}layerElevationInfoChanged(t,e){return this.updateGraphics3DGraphicElevationInfo(t,e,S.B5)}slicePlaneEnabledChanged(t,e){return this._materials[pt.Main]?.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),this._materials[pt.Bottom]?.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),t.forEach((t=>{const n=e(t);null!=n&&n.slicePlaneEnabledChanged(this._context.slicePlaneEnabled,this._context.isAsync)})),!0}physicalBasedRenderingChanged(){const t={usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0};return this._materials[pt.Main]?.setParameters(t),this._materials[pt.Bottom]?.setParameters(t),!0}_getExtrusionSize(t){let e;return e=t.size&&this._drivenProperties.size?(0,_.sV)(t.size,2)??0:this._getSymbolSize(),e/=this._context.renderCoordsHelper.unitInMeters,e}applyRendererDiff(t,e){return this._drivenPropertiesChanged(e)?E.W.RecreateSymbol:E.W.RecreateGraphics}async queryForSnapping(t,e,n,i){const r=this._getExtrusionSize(n)*this._context.renderCoordsHelper.unitInMeters/(0,o._R)(e),{objectId:a,target:l}=t,c=(0,s.d9)(l);switch(c.z=(c.z??0)+r,t.type){case"edge":{const{start:e,end:n}=t,i=(0,s.d9)(e),o=(0,s.d9)(n);return i.z=(i.z??0)+r,o.z=(o.z??0)+r,[(0,m.p)(a,c,1/0,i,o)]}case"vertex":return[(0,m.u)(a,c,1/0),(0,m.p)(a,l,1/0,l,c)];default:return[]}}_getSymbolSize(){return this.symbolLayer.size??1}_createAs3DShape(t,e,n,i,s){const o=(0,I.Nu)(t.geometry);if(null==o)return null;if(0===o.rings.length||!o.rings.some((t=>t.length>0)))return this._logGeometryValidationWarnings(o.rings,"rings","ExtrudeSymbol3DLayer"),null;const m=(0,U.VP)(o,this._context.elevationProvider,this._context.renderCoordsHelper,i);this._logGeometryCreationWarnings(m,o.rings,"rings","ExtrudeSymbol3DLayer");const _=(0,P.zE)(o);if(null==_)return null;const w=new Array,E=new Array,T=(0,g.Ue)(),M=(0,u.Ue)(),L=(0,p.Ue)(),A=this._context.renderCoordsHelper.viewingMode===x.JY.Global;A||this._context.renderCoordsHelper.worldUpAtPosition(null,L),(0,d.B)(o.spatialReference,[_.x,_.y,0],M,this._context.renderCoordsHelper.spatialReference);const V=(0,u.Ue)();(0,c.U_)(V,M);const k=(0,l.Ue)();(0,a.XL)(k,V);const{polygons:F,mapPositions:G,position:q}=m,H=new Map,W=this._materials[pt.Main];for(const a of F){const t=a.count;if(this._context.clippingExtent&&((0,g.FY)(a.mapPositions,T),!(0,g.Zp)(T,this._context.clippingExtent)))continue;const i=(0,r.e)(a.mapPositions,a.holeIndices,3);if(0===i.length)continue;const o=i.length,l=6*t,c=(0,f.$z)(l+o),u=(0,f.$z)(o),h=(0,y.bg)(3*l),p=(0,y.bg)(3*l),d=(0,y.bg)(3*l),m=(0,y.bg)(l);j(q,G,i,a,h,d,p,m,c,u,this._getExtrusionSize(e),L,A),(0,b.t)(h,h,V);const _=this._context.stage.renderView.getObjectAndLayerIdColor({graphicUid:s,layerUid:this._context.layer.uid}),x=new gt(h,d,(0,D.nG)(p),m),S=Z(W,c,c.length-u.length,x,n,_),v=t,P=t,I=2*a.count,O=new yt(v,P,I,o/3);et(S,O,M),H.set(S,O),w.push(S,Z(this._materials[pt.Bottom],u,0,x,n,_)),E.push(x.heights)}if(0===w.length)return null;const J=new B.T({geometries:w,layerUid:this._context.layer.uid,graphicUid:s,isElevationSource:!0});J.transformation=M;const Y=(0,O.hM)(this.symbolLayer,{opacity:this._getLayerOpacity()}),$=Y?new v.n(this._materials[pt.Main],Y,this._context.slicePlaneEnabled):null,K=new v.z(this,J,w,null,null,((t,e,n,i,s)=>function(t,e,n,i,s,o,r){const a=t.stageObject,l=a.geometries,p=l.length,d="absolute-height"!==e.mode;let g=0;const y=a.transformation,f=(0,c.iS)((0,u.Ue)(),y);for(let c=0;c<p;c+=2){const t=l[c];if(!(0,z.T)(t))continue;const e=t.getMutableAttribute(N.T.POSITION).data,u=o[c/2],p=new R.sb(t.mapPositions),b=e.length/3;let m=!1,_=0;{let t=0;for(let o=0;o<b;o++){tt[0]=e[t],tt[1]=e[t+1],tt[2]=e[t+2],i(p,st),d&&(_+=st.sampledElevation),C.h.TESTS_DISABLE_OPTIMIZATIONS?((0,h.i)(nt,p.array[p.offset],p.array[p.offset+1],st.z+u[t/3]),null!=n&&s.toRenderCoords(nt,n,nt),(0,h.t)(nt,nt,f)):((0,h.i)(nt,e[t],e[t+1],e[t+2]),(0,h.t)(nt,nt,y),s.setAltitude(nt,st.z+u[t/3]),(0,h.t)(nt,nt,f)),e[t]=nt[0],e[t+1]=nt[1],e[t+2]=nt[2];const o=at/s.unitInMeters;(Math.abs(tt[0]-e[t])>=o||Math.abs(tt[1]-e[t+1])>=o||Math.abs(tt[2]-e[t+2])>=o)&&(m=!0),p.offset+=3,t+=3}}if(m){const e=r.get(t);e&&et(t,e,y),a.geometryVertexAttributeUpdated(l[c],N.T.NORMALCOMPRESSED),t.invalidateBoundingInfo(),a.geometryVertexAttributeUpdated(l[c],N.T.POSITION),l[c+1].invalidateBoundingInfo(),a.geometryVertexAttributeUpdated(l[c+1],N.T.POSITION)}g+=_/b}return g/p}(t,e,n,i,s,E,H)),i,$);return K.alignedSampledElevation=m.sampledElevation,K.needsElevationUpdates=(0,S.B5)(i.mode),K}}function Z(t,e,n,i,s,o){const r=(0,f.LE)(e.length),a=[[N.T.POSITION,new M.a(i.positions,e,3,!0)],[N.T.NORMALCOMPRESSED,new M.a(i.normals,e,2,!0)],[N.T.COLOR,new M.a(s,r,4,!0)]];return new V.Z(t,a,i.elevation,A.U.Mesh,o,n)}function j(t,e,n,i,s,o,r,a,l,c,u,p,d){{const g=n.length/3,y=2*i.count;!function(t,e,n,i,s,o,r,a,l,c,u,p,d,g,y,f,b){(0,h.c)(it,f);{const s=y>0?1:-1;let o=3*n,r=0,p=3*r,d=i,g=3*d;for(let n=0;n<i;++n){const n=t[o],i=t[o+1],f=t[o+2];b&&(it[0]=n,it[1]=i,it[2]=f,(0,h.n)(it,it)),a[p+0]=n,a[p+1]=i,a[p+2]=f;const m=e[o+0],_=e[o+1],x=e[o+2];l[p+0]=m,l[p+1]=_,l[p+2]=x,c[p+0]=-s*it[0],c[p+1]=-s*it[1],c[p+2]=-s*it[2],u[r]=0,a[g+0]=n+y*it[0],a[g+1]=i+y*it[1],a[g+2]=f+y*it[2],l[g+0]=m,l[g+1]=_,l[g+2]=x,u[d]=y,p+=3,g+=3,o+=3,r+=1,d+=1}}{let t=3*o,e=0,n=3*g;const a=y<0?rt:ot,l=y<0?ot:rt;for(let o=0;o<r;++o)d[e]=s[t+a[0]],d[e+1]=s[t+a[1]],d[e+2]=s[t+a[2]],p[n]=s[t+l[0]]+i,p[n+1]=s[t+l[1]]+i,p[n+2]=s[t+l[2]]+i,e+=3,n+=3,t+=3}}(t,e,i.index,i.count,n,0,g,s,o,r,a,l,c,y,u,p,d)}{let t=0,e=2*i.count,n=0;const c=i.pathLengths[0];W(s,o,a,r,t,c,i.count,e,l,n,u),e+=4*c,n+=2*c,t+=c;for(let h=1;h<i.pathLengths.length;++h){const c=i.pathLengths[h];W(s,o,a,r,t,c,i.count,e,l,n,u),e+=4*c,n+=2*c,t+=c}}}function q(t,e,n,i,s,o,r){i[o]=i[r],r*=3,t[o*=3]=t[r],t[o+1]=t[r+1],t[o+2]=t[r+2],e[o]=e[r],e[o+1]=e[r+1],e[o+2]=e[r+2],n[o]=s[0],n[o+1]=s[1],n[o+2]=s[2]}const H=(0,p.Ue)();function W(t,e,n,i,s,o,r,a,l,c,u){let h=s,p=s+1,d=s+r,g=s+r+1,y=a,f=a+1,b=a+2*o,m=a+2*o+1;u<0&&(h=s+r+1,g=s);let _=3*c;for(let x=0;x<o;++x)x===o-1&&(p=s,u>0?g=s+r:h=s+r),Q(t,h,p,d,H),q(t,e,i,n,H,y,h),q(t,e,i,n,H,f,p),q(t,e,i,n,H,b,d),q(t,e,i,n,H,m,g),l[_]=y,l[_+1]=b,l[_+2]=m,l[_+3]=y,l[_+4]=m,l[_+5]=f,_+=6,h++,p++,d++,g++,y+=2,f+=2,b+=2,m+=2}const J=(0,p.Ue)(),Y=(0,p.Ue)(),$=(0,p.Ue)(),K=(0,p.Ue)(),X=(0,p.Ue)();function Q(t,e,n,i,s){e*=3,n*=3,i*=3,(0,h.i)(J,t[e++],t[e++],t[e++]),(0,h.i)(Y,t[n++],t[n++],t[n++]),(0,h.i)($,t[i++],t[i++],t[i++]),(0,h.d)(K,Y,J),(0,h.d)(X,$,J),(0,h.e)(s,X,K),(0,h.n)(s,s)}const tt=(0,p.Ue)();function et(t,e,n){const i=t.getMutableAttribute(N.T.POSITION),s=t.getMutableAttribute(N.T.NORMALCOMPRESSED).data,{topVertexStart:o,topVertexCount:r,topFaceStart:a,topFaceCount:l}=e,c=i.data,u=r,p=t.attributes.get(N.T.POSITION).indices,d=a+l,g=o+r,f=(0,y.bg)(3*u);for(let h=0;h<u;++h){const t=3*h;f[t+0]=0,f[t+1]=0,f[t+2]=0}const b=lt,m=ct,_=ut,x=ht,S=it;for(let y=a;y<d;++y){const t=3*y;for(let e=0;e<3;++e){const i=p[t+e];x[e]=i;const s=3*i;(0,h.i)(nt,c[s+0],c[s+1],c[s+2]),(0,h.t)(b[e],nt,n)}(0,h.a)(m,b[1],b[0]),(0,h.a)(_,b[2],b[0]),(0,h.e)(S,m,_),(0,h.n)(S,S);for(let e=0;e<3;++e){const t=3*(x[e]-o);f[t+0]+=S[0],f[t+1]+=S[1],f[t+2]+=S[2]}}for(let h=o;h<g;++h){const t=3*(h-o),e=f[t+0],n=f[t+1],i=f[t+2],r=Math.sqrt(e*e+n*n+i*i);(0,D.hd)(s,h,e/r,n/r,i/r)}}const nt=(0,p.Ue)(),it=(0,p.Ue)(),st=new S.Lm,ot=[0,2,1],rt=[0,1,2],at=.01,lt=[(0,p.Ue)(),(0,p.Ue)(),(0,p.Ue)()],ct=(0,p.Ue)(),ut=(0,p.Ue)(),ht=[0,0,0];var pt,dt;(dt=pt||(pt={}))[dt.Main=0]="Main",dt[dt.Bottom=1]="Bottom";class gt{constructor(t,e,n,i){this.positions=t,this.elevation=e,this.normals=n,this.heights=i}}class yt{constructor(t,e,n,i){this.topVertexStart=t,this.topVertexCount=e,this.topFaceStart=n,this.topFaceCount=i}}},64098:(t,e,n)=>{n.d(e,{JJ:()=>b,LN:()=>d,Nu:()=>f,dd:()=>y,z:()=>g});n(59486);var i=n(79347),s=n(14320),o=n(39406),r=n(26844),a=n(91526),l=n(79100),c=n(2952),u=n(4760),h=n(53866),p=n(80885);function d(t,e,n){const o=(e.length>0?e[0]:t.length/3)-1,a=(0,r.i)(t,o,n);if(a!==s.R.Z){t=t.slice();for(let e=0;e<t.length;e+=3)t[e+a]=t[e+2]}return(0,i.e)(t,e,3)}function g(t){const e=[[u.T.POSITION,new a.a(t.attributeData.position,t.indices,3,!0)]],n=(0,o.LE)(t.indices.length);return null!=t.attributeData.colorFeature?e.push([u.T.COLORFEATUREATTRIBUTE,new a.a([t.attributeData.colorFeature],n,1,!0)]):t.attributeData.color&&e.push([u.T.COLOR,new a.a(t.attributeData.color,n,4,!0)]),t.attributeData.uvMapSpace&&e.push([u.T.UVMAPSPACE,new a.a(t.attributeData.uvMapSpace,t.indices,4,!0)]),t.attributeData.boundingRect&&e.push([u.T.BOUNDINGRECT,new a.a(t.attributeData.boundingRect,t.indices,9,!0)]),new c.Z(t.material,e,t.mapPositions,l.U.Mesh,t.attributeData.objectAndLayerIdColor)}function y(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=[[u.T.POSITION,new a.a(t.attributeData.position,t.indices,3,!0)],[u.T.UV0,new a.a(t.attributeData.uv0,t.indices,2,!0)]];return new c.Z(t.material,n,t.mapPositions,l.U.Mesh,e)}function f(t){switch(t.type){case"extent":if(t instanceof h.Z)return p.Z.fromExtent(t);break;case"polygon":return t}return null}class b{constructor(t,e,n){this.renderData=t,this.layerUid=e,this.graphicUid=n,this.outGeometries=new Array}}},27689:(t,e,n)=>{n.d(e,{VP:()=>l,rm:()=>c});var i=n(50628),s=n(86372),o=n(91320),r=n(69691),a=n(19265);function l(t,e,n,i){const a=(0,o.Ni)(t.rings,!!t.hasZ&&"on-the-ground"!==i.mode,o.ZI.CCW_IS_HOLE,t.spatialReference),l=(0,s.bg)(a.position.length),c=(0,r.rR)(a.position,t.spatialReference,0,l,0,a.position,0,a.position.length/3,e,n,i),p=null!=c;return new f(a.position,l,h(a.polygons,a.position,l),u(a.outlines,a.position,l),p,c)}function c(t,e){const n=(0,o.Ni)(t.rings,!1,o.ZI.CCW_IS_HOLE),s=(0,i.projectBuffer)(n.position,t.spatialReference,0,n.position,e,0);for(let i=2;i<n.position.length;i+=3)n.position[i]=a.gi;return{position:n.position,polygons:h(n.polygons,n.position),outlines:u(n.outlines,n.position),projectionSuccess:s}}function u(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return t.filter((t=>{let{count:e}=t;return e>1})).map((t=>{let{index:i,count:o}=t;const r=3*i,a=3*o;return null!=n?new d(i,o,(0,s.Rq)(e,r,a),(0,s.Rq)(n,r,a)):new p(i,o,(0,s.Rq)(e,r,a))}))}function h(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=new Array;for(const{index:o,count:r,holeIndices:a,pathLengths:l}of t){if(r<=1)continue;const t=3*o,c=3*r,u=a.map((t=>t-o)),h=null!=n?new g(o,r,(0,s.Rq)(e,3*o,3*r),(0,s.Rq)(n,t,c),u,l):new y(o,r,(0,s.Rq)(e,3*o,3*r),u,l);i.push(h)}return i}class p{constructor(t,e,n){this.index=t,this.count=e,this.position=n}}class d extends p{constructor(t,e,n,i){super(t,e,n),this.mapPositions=i}}class g extends d{constructor(t,e,n,i,s,o){super(t,e,n,i),this.holeIndices=s,this.pathLengths=o}}class y extends p{constructor(t,e,n,i,s){super(t,e,n),this.holeIndices=i,this.pathLengths=s}}class f{constructor(t,e,n,i,s,o){this.position=t,this.mapPositions=e,this.polygons=n,this.outlines=i,this.projectionSuccess=s,this.sampledElevation=o}}}}]);
//# sourceMappingURL=4714.a27a4b56.chunk.js.map